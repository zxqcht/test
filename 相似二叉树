#include <stdio.h>
#include <stdlib.h>

int E=0,F=0;
typedef struct node{
    char data;
    struct node *lchild,*rchild;
}node;

node* create(){
    node *T;
    char c;
    scanf(" %c",&c);
    if(c=='0'){
        T=NULL;
    }
    else{
        T=(node*)malloc(sizeof(node));
        T->data=c;
        T->lchild=create();
        T->rchild=create();
    }
    return T;
}

print(node *T){
    if(T==NULL){
        return 0;
    }
    printf("%c ",T->data);
    print(T->lchild);
    print(T->rchild);
}

int parent(char x,node *r){
    if(r==NULL)
        return 0;
    if(r->data==x){
        return 1;
    }
    if(parent(x,r->lchild)||parent(x,r->rchild)){
        printf("%c",r->data);
    }
    else{
        return 0;
    }
}

void visit(node *b){
    printf("%c",b->data);
}

void cht(node *T,char x){
    if(!T)
        printf("0");
    node *s[100],*pre;
    int top=-1,c=0,d=0;
    while(T||top!=-1){
        while(T){
            s[++top]=T;
            T=T->lchild;
        }
        if(top!=-1){
            T=s[top];
            if(T->rchild==NULL||T->rchild==pre){
                top--;
                if(T->data==x){
                    c=c+1;
                    while(top!=-1){
                        visit(s[top--]);
                        d=d+1;
                    }
                }
                pre=T;
                T=NULL;
            }
            else
                T=T->rchild;
        }
    }
    if(c==0||d==0){
        printf("0");
    }
}

int similar(node *s,node *t){
    if(s==NULL&&t==NULL)
        return 1;
    else if(s==NULL||t==NULL){
        return 0;
    }
    else{
        return (similar(s->lchild,t->lchild)&&similar(s->rchild,t->rchild));
    }
}

int similar2(node *s,node *t){
    if(s==NULL&&t==NULL)
        return F;
    else if(s==NULL||t==NULL){
        return F;
    }
    else if(s->data==t->data&&s->data!='0'&&t->data!='0'){
        F=F+1;
        similar2(s->lchild,t->lchild);
        similar2(s->rchild,t->rchild);
        return F;
    }
    else{
        return (similar2(s->lchild,t->lchild)&&similar2(s->rchild,t->rchild));
    }
}


int len(node *T){
    if(T==NULL){
        return 0;
    }
    else{
       E=E+1;
       len(T->lchild);
       len(T->rchild);
    }
    return E;
}

int main(){
    node *M,*N;
    int a,b,c;
    M=create();
    N=create();
    a=similar(M,N);
    b=similar2(M,N);
    c=len(M);
    printf("%d  ",a);
    printf("%d %d",b,c);
    if(a==1&&b>=(c+1)/2){
        printf("1");
    }
    else{
        printf("0");
    }
}
